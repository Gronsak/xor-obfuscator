# Obfuscator
Final project for a course in programming for penetration testers.

The tool takes a file of shellcode and does an xor obfuscation on it and outputs it as a raw binary file or a string formated as either C char array or a Pyhton literal b"".

## USAGE
`obfuscator.py [-h] [-f] -k KEY [-m {r,raw,c,c-array,p,python}] [-o OUTPUT] [-t] [-v] shellcodePath`
### Arguments
#### shellcodePath
The path to a shellcode binary file that will be obfuscated using xor.
### Options
#### -h, --help
show a help message.
#### -f, --force, --overwrite
Skip overwrite prompt and always overwrite existing output file.
#### -k, --key KEY         
The key for the xor operation, KEY can be either as as a single byte formated as HEX `0x42` or as a string `example123` that will be converted to bytes for used in xor:ed.
#### -m, --mode {r,raw,c,c-array,p,python}
Format mode for the output

Possible choices  
r, raw - raw binary output. (default)  
c, c-array - As a C/C++ array for use in C/C++ code.  
p, python - as a Python literal for use in Python code.
#### -o, --output OUTPUT   
Output path for xor obfuscated shellcode.  
If omitted, raw mode will result in no output but program will still run.
#### -t, --terminal
If possible show output data in terminal.
#### -v, --verbose
Print status messages and output data, if possible, while running the program.

### Simple example command:
```sh
python obfuscator.py shellcode.bin -k 0x42 -o obfuscated_code.xor
```
This command will output a binary file named `obfuscated_code.xor` with the data xor:ed using `0x42` as a key
## Output
The output can either be directly written to a file using the -o/--output flag or written to the terminal standard output if -o/--output is ommited or both using either -t/--terminal or -v/--verbose.
### Examples
#### Command
```sh
python obfuscator.py shellcode.bin -tk 0x42 --mode c-array
```
Output
```c
unsigned char xored_shellcode[] = {
    0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a,
    0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a,
    0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a,
    0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a,
    0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a,
    0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a,
    0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a,
    0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a,
    0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a,
    0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a,
    0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a,
    0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a,
    0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a,
    0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a,
    0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a,
    0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a,
    0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a,
    0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a,
    0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a,
    0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a,
    0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a,
    0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a,
    0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a,
    0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a,
    0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a,
    0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a,
    0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a, 0x1a
};
```
#### Command
```sh
python obfuscator.py shellcode.bin -tk 0x42 --mode python
```
Output:
```python
shellcode = b""
shellcode += b"\xbe\x0a\xc3\xa6\xb2\xbd\xbd\xbd\xaa\x8e\x42\x42\x42\x03\x13"
shellcode += b"\x03\x12\x10\x13\x14\x0a\x73\x90\x27\x0a\xc9\x10\x22\x0a\xc9"
shellcode += b"\x10\x5a\x0a\xc9\x10\x62\x0f\x73\x8b\x0a\xc9\x30\x12\x0a\x4d"
shellcode += b"\xf5\x08\x08\x0a\x73\x82\xee\x7e\x23\x3e\x40\x6e\x62\x03\x83"
shellcode += b"\x8b\x4f\x03\x43\x83\xa0\xaf\x10\x0a\xc9\x10\x62\x03\x13\xc9"
shellcode += b"\x00\x7e\x0a\x43\x92\x24\xc3\x3a\x5a\x49\x40\x4d\xc7\x30\x42"
shellcode += b"\x42\x42\xc9\xc2\xca\x42\x42\x42\x0a\xc7\x82\x36\x25\x0a\x43"
shellcode += b"\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a"
shellcode += b"\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a"
shellcode += b"\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a"
shellcode += b"\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a"
shellcode += b"\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a"
shellcode += b"\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a"
shellcode += b"\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a"
shellcode += b"\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a"
shellcode += b"\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a"
shellcode += b"\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a"
shellcode += b"\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a"
shellcode += b"\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a"
shellcode += b"\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a"
shellcode += b"\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a\x1a"
shellcode += b"\x1a\x1a\x1a\x1a\x1a\x1a"
```
#### Command
```sh
python obfuscator.py shellcode.bin -k 0x42 --mode raw --verbose -o shellcode.xor
```
Output:
```
[+] Input: shellcode.bin (321bytes)
[+] Output: shellcode.xor
[+] Format: raw
[+] Key: 0x42 (mode:hex)
[+] Running xor operation...
[+] New data length: 321bytes
[+] Writing obfuscated data to: shellcode.xor
[+] Program finished!
    Happy hacking!
```